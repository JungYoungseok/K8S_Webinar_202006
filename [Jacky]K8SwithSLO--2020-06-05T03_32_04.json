{"title":"[Jacky] K8S with SLO","description":"This dashboard visualizes high-level resource metrics from your EC2 instances, so you can monitor the performance of your AWS compute infrastructure. Further reading on AWS EC2 monitoring:\n\n- [Datadog's guide to key AWS EC2 metrics](https://www.datadoghq.com/blog/ec2-monitoring/)\n\n- [How to collect AWS EC2 metrics using AWS CloudWatch](https://www.datadoghq.com/blog/collecting-ec2-metrics/)\n\n- [How to monitor AWS EC2 with Datadog](https://www.datadoghq.com/blog/monitoring-ec2-instances-with-datadog/)\n\n- [Datadog's AWS EC2 integration docs](https://docs.datadoghq.com/integrations/amazon_ec2/)\n\nClone this template AWS EC2 dashboard to make changes and add your own graph widgets.","widgets":[{"id":0,"definition":{"type":"note","content":"CPU","background_color":"gray","font_size":"18","text_align":"center","show_tick":true,"tick_pos":"50%","tick_edge":"right"},"layout":{"x":4,"y":26,"width":12,"height":23}},{"id":1,"definition":{"type":"note","content":"Memory","background_color":"gray","font_size":"18","text_align":"center","show_tick":true,"tick_pos":"50%","tick_edge":"bottom"},"layout":{"x":4,"y":49,"width":12,"height":23}},{"id":2,"definition":{"type":"timeseries","requests":[{"q":"avg:system.cpu.system{$CloudProvider,$Host,$cluster-name} by {host}+avg:system.cpu.user{$CloudProvider,$Host,$cluster-name} by {host}","display_type":"line","style":{"palette":"warm","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"CPU utilization","title_size":"13","title_align":"left","time":{"live_span":"4h"},"show_legend":false,"legend_size":"0"},"layout":{"x":54,"y":26,"width":60,"height":23}},{"id":3,"definition":{"type":"toplist","requests":[{"q":"top((avg:system.disk.total{$CloudProvider,$Host,$cluster-name} by {host}-avg:system.disk.used{$CloudProvider,$Host,$cluster-name} by {host})/avg:system.disk.total{$CloudProvider,$Host,$cluster-name} by {host}*100,10,'mean','asc')"}],"title":"Disk 가용공간 (%)","title_size":"13","title_align":"left","time":{"live_span":"4h"}},"layout":{"x":54,"y":72,"width":30,"height":23}},{"id":4,"definition":{"type":"toplist","requests":[{"q":"top(avg:system.mem.total{$CloudProvider,$Host,$cluster-name} by {host}-avg:system.mem.used{$CloudProvider,$Host,$cluster-name} by {host},10,'mean','asc')"}],"title":"Memory available GB","title_size":"13","title_align":"left","time":{"live_span":"4h"}},"layout":{"x":54,"y":49,"width":30,"height":23}},{"id":5,"definition":{"type":"note","content":"I/O","background_color":"gray","font_size":"18","text_align":"center","show_tick":true,"tick_pos":"50%","tick_edge":"bottom"},"layout":{"x":4,"y":72,"width":12,"height":23}},{"id":6,"definition":{"type":"note","content":"Network","background_color":"gray","font_size":"18","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"bottom"},"layout":{"x":4,"y":95,"width":12,"height":23}},{"id":7,"definition":{"type":"hostmap","requests":{"fill":{"q":"avg:system.cpu.system{$cluster-name} by {host}"}},"title":"CPU 특이사항 맵","title_size":"16","title_align":"left","node_type":"host","no_metric_hosts":false,"no_group_hosts":false,"scope":["$cluster-name"],"style":{"palette":"green_to_orange","palette_flip":false}},"layout":{"x":16,"y":26,"width":38,"height":23}},{"id":8,"definition":{"type":"hostmap","requests":{"fill":{"q":"avg:system.mem.used{$cluster-name} by {host}"}},"title":"Memory 특이사항 맵","title_size":"16","title_align":"left","node_type":"host","no_metric_hosts":false,"no_group_hosts":false,"scope":["$cluster-name"],"style":{"palette":"green_to_orange","palette_flip":false}},"layout":{"x":16,"y":49,"width":38,"height":23}},{"id":9,"definition":{"type":"hostmap","requests":{"fill":{"q":"avg:system.disk.write_time_pct{$cluster-name} by {host}"},"size":{"q":"avg:system.disk.read_time_pct{$cluster-name} by {host}"}},"title":"Disk IO 특이사항 맵","title_size":"16","title_align":"left","node_type":"host","no_metric_hosts":false,"no_group_hosts":false,"scope":["$cluster-name"],"style":{"palette":"green_to_orange","palette_flip":false}},"layout":{"x":16,"y":72,"width":38,"height":23}},{"id":10,"definition":{"type":"note","content":"Worker Node 상태","background_color":"vivid_yellow","font_size":"24","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"right"},"layout":{"x":4,"y":21,"width":110,"height":5}},{"id":11,"definition":{"type":"hostmap","requests":{"fill":{"q":"avg:system.net.bytes_sent{$cluster-name} by {host}"}},"title":"Network 특이사항 맵","title_size":"16","title_align":"left","node_type":"host","no_metric_hosts":false,"no_group_hosts":false,"group":[],"scope":["$cluster-name"],"style":{"palette":"green_to_orange","palette_flip":false}},"layout":{"x":16,"y":95,"width":38,"height":23}},{"id":12,"definition":{"type":"timeseries","requests":[{"q":"avg:system.net.bytes_sent{$CloudProvider,$Host,$cluster-name} by {host}","display_type":"line","style":{"palette":"purple","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"호스트별 Network 사용량 (Out)","title_size":"16","title_align":"left","time":{"live_span":"4h"},"show_legend":false,"legend_size":"0"},"layout":{"x":54,"y":95,"width":30,"height":23}},{"id":13,"definition":{"type":"timeseries","requests":[{"q":"avg:system.net.bytes_rcvd{$CloudProvider,$Host,$cluster-name} by {host}","display_type":"line","style":{"palette":"purple","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"호스트별 Network 사용량(IN)","title_size":"16","title_align":"left","time":{"live_span":"4h"},"show_legend":false,"legend_size":"0"},"layout":{"x":84,"y":95,"width":30,"height":23}},{"id":14,"definition":{"type":"timeseries","requests":[{"q":"avg:system.mem.total{$CloudProvider,$Host,$cluster-name} by {host}-avg:system.mem.used{$CloudProvider,$Host,$cluster-name} by {host}","display_type":"line","style":{"palette":"green","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"Memory available GB","title_size":"16","title_align":"left","time":{"live_span":"4h"},"show_legend":false,"legend_size":"0"},"layout":{"x":84,"y":49,"width":30,"height":23}},{"id":15,"definition":{"type":"timeseries","requests":[{"q":"avg:system.mem.total{$CloudProvider,$Host,$cluster-name} by {host}-avg:system.mem.used{$CloudProvider,$Host,$cluster-name} by {host}","display_type":"line","style":{"palette":"purple","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"Disk 가용공간 (%)","title_size":"16","title_align":"left","time":{"live_span":"4h"},"show_legend":false,"legend_size":"0"},"layout":{"x":84,"y":72,"width":30,"height":23}},{"id":16,"definition":{"title":"Availability SLO","title_size":"16","title_align":"left","slo_id":"913a51a2f6795135b4976424dabda560","type":"slo","time_windows":["7d"],"view_type":"detail","view_mode":"both","show_error_budget":true},"layout":{"x":46,"y":-1,"width":23,"height":21}},{"id":17,"definition":{"title":"졍상 요청 비율 SLO","title_size":"16","title_align":"center","slo_id":"1a00e4d39ae75ecab416e2882e4aea43","type":"slo","time_windows":["7d"],"view_type":"detail","view_mode":"overall","show_error_budget":true},"layout":{"x":92,"y":-1,"width":22,"height":21}},{"id":18,"definition":{"title":"API Latency SLO","title_size":"16","title_align":"left","slo_id":"7e3f38f6a9bc564f8c54dc5c3b56da20","type":"slo","time_windows":["7d"],"view_type":"detail","view_mode":"overall","show_error_budget":true},"layout":{"x":69,"y":-1,"width":23,"height":21}},{"id":19,"definition":{"type":"manage_status","summary_type":"combined","query":"","sort":"status,asc","count":50,"start":0,"display_format":"countsAndList","color_preference":"text","hide_zero_counts":true,"title":"Alert 현황","title_size":"13","title_align":"left","show_last_triggered":false},"layout":{"x":4,"y":0,"width":42,"height":19}},{"id":20,"definition":{"type":"toplist","requests":[{"q":"top(sum:kubernetes.memory.usage{*,*,*,!pod_name:no_pod,*,*,*,*} by {pod_name}, 10, 'mean', 'desc')"}],"title":"Most memory-intensive pods","title_size":"16","title_align":"left","time":{"live_span":"4h"}},"layout":{"x":144,"y":50,"width":28,"height":24}},{"id":21,"definition":{"type":"toplist","requests":[{"q":"top(sum:kubernetes.cpu.usage.total{*,*,*,!pod_name:no_pod,*,*,*,*} by {pod_name}, 10, 'mean', 'desc')"}],"title":"Most CPU-intensive pods","title_size":"16","title_align":"left","time":{"live_span":"4h"}},"layout":{"x":115,"y":50,"width":28,"height":24}},{"id":22,"definition":{"type":"timeseries","requests":[{"q":"sum:kubernetes_state.pod.status_phase{*,*,*,pod_phase:failed,*,*,*,*}, sum:kubernetes_state.pod.status_phase{*,*,*,pod_phase:pending,*,*,*,*}, sum:kubernetes_state.pod.status_phase{*,*,*,pod_phase:running,*,*,*,*}, sum:kubernetes_state.pod.status_phase{*,*,*,pod_phase:succeeded,*,*,*,*}","metadata":[{"expression":"sum:kubernetes_state.pod.status_phase{$cluster,$namespace,$deployment,pod_phase:failed,$scope}","alias_name":"Failed pods"},{"expression":"sum:kubernetes_state.pod.status_phase{$cluster,$namespace,$deployment,pod_phase:succeeded,$scope}","alias_name":"Succeeded pods"},{"expression":"sum:kubernetes_state.pod.status_phase{$cluster,$namespace,$deployment,pod_phase:pending,$scope}","alias_name":"Pending pods"},{"expression":"sum:kubernetes_state.pod.status_phase{$cluster,$namespace,$deployment,pod_phase:running,$scope}","alias_name":"Running pods"}],"display_type":"area","style":{"palette":"cool","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"Pods Status Phase","title_size":"16","title_align":"left","show_legend":true,"legend_size":"0"},"layout":{"x":172,"y":50,"width":57,"height":24}},{"id":23,"definition":{"type":"toplist","requests":[{"q":"top(sum:kubernetes.pods.running{*,*,*,*,*,*,*} by {kubernetes_cluster,kube_namespace}, 100, 'max', 'desc')","conditional_formats":[{"comparator":">","value":2000,"palette":"white_on_red"},{"comparator":">","value":1500,"palette":"white_on_yellow"},{"comparator":"<=","value":3000,"palette":"white_on_green"}]}],"title":"Pods Running By Namespace","title_size":"16","title_align":"left"},"layout":{"x":115,"y":74,"width":28,"height":16}},{"id":24,"definition":{"type":"toplist","requests":[{"q":"top(sum:kubernetes_state.pod.ready{*,*,*,*,condition:true,*,*,*} by {kubernetes_cluster,host,nodepool}, 10, 'last', 'desc')","conditional_formats":[{"comparator":"<=","value":24,"palette":"white_on_green"},{"comparator":">","value":32,"palette":"white_on_red"},{"comparator":">","value":24,"palette":"white_on_yellow"}]}],"title":"Pods in Ready State By Node","title_size":"16","title_align":"left"},"layout":{"x":144,"y":74,"width":28,"height":16}},{"id":25,"definition":{"type":"toplist","requests":[{"q":"top(exclude_null(sum:kubernetes_state.pod.ready{condition:false,*,*,*,*,*,*,*} by {kube_namespace}), 25, 'last', 'desc')","conditional_formats":[{"comparator":">","value":0,"palette":"white_on_red"},{"comparator":"<=","value":0,"palette":"white_on_green"}]}],"title":"Pods in Bad State (Not Ready) by Namespace","title_size":"16","title_align":"left"},"layout":{"x":172,"y":74,"width":57,"height":16}},{"id":26,"definition":{"type":"timeseries","requests":[{"q":"avg:kubernetes.cpu.usage.total{*,*,*,*,*,*,*} by {pod_name}","display_type":"line","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"CPU Usage by Pod","title_size":"16","title_align":"left","show_legend":true,"legend_size":"0"},"layout":{"x":115,"y":26,"width":57,"height":24}},{"id":27,"definition":{"type":"timeseries","requests":[{"q":"avg:kubernetes.memory.usage{*,*,*,*,*,*,*} by {pod_name}","display_type":"line","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"Memory Usage by Pod","title_size":"16","title_align":"left","show_legend":true,"legend_size":"0"},"layout":{"x":172,"y":26,"width":57,"height":24}},{"id":28,"definition":{"type":"note","content":"Pods","background_color":"purple","font_size":"18","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"bottom"},"layout":{"x":115,"y":21,"width":114,"height":5}},{"id":29,"definition":{"type":"note","content":"Containers","background_color":"green","font_size":"18","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"bottom"},"layout":{"x":115,"y":91,"width":114,"height":5}},{"id":30,"definition":{"type":"timeseries","requests":[{"q":"sum:kubernetes_state.container.ready{*,*,*,*,*,*,*}, sum:kubernetes_state.container.running{*,*,*,*,*,*,*}, sum:kubernetes_state.container.terminated{*,*,*,*,*,*,*}, sum:kubernetes_state.container.waiting{*,*,*,*,*,*,*}","display_type":"line","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"Containers States","title_size":"16","title_align":"left","show_legend":true,"legend_size":"0"},"layout":{"x":115,"y":96,"width":57,"height":24}},{"id":31,"definition":{"type":"timeseries","requests":[{"q":"sum:kubernetes_state.container.restarts{*,*,*,*,*,*,*} by {pod_name}","display_type":"area","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"Container Restarts by Pod","title_size":"16","title_align":"left","show_legend":false,"legend_size":"4"},"layout":{"x":172,"y":96,"width":57,"height":24}},{"id":32,"definition":{"type":"timeseries","requests":[{"q":"sum:kubernetes_state.container.waiting{*,*,*,reason:crashloopbackoff,*,*,*,*} by {pod_name}","display_type":"bars","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"Containers in CrashloopBackOff (by Pod)","title_size":"16","title_align":"left","show_legend":false,"legend_size":"0"},"layout":{"x":115,"y":120,"width":57,"height":24}},{"id":33,"definition":{"type":"timeseries","requests":[{"q":"sum:kubernetes_state.container.terminated{*,*,*,reason:OOMKilled,*,*,*} by {pod_name}","display_type":"bars","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"Containers OOM Killed (by Pod)","title_size":"16","title_align":"left","show_legend":true,"legend_size":"0"},"layout":{"x":172,"y":120,"width":57,"height":24}},{"id":34,"definition":{"type":"timeseries","requests":[{"q":"sum:kubernetes.cpu.usage.total{*,*,*,*,*,*,*} by {kube_container_name,container_id}","display_type":"line","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"CPU Usage by Container","title_size":"16","title_align":"left","show_legend":true,"legend_size":"0"},"layout":{"x":115,"y":144,"width":57,"height":24}},{"id":35,"definition":{"type":"timeseries","requests":[{"q":"sum:kubernetes.memory.usage{*,*,*,*,*,*,*} by {kube_container_name,container_id}","display_type":"line","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"Memory Usage by Container","title_size":"16","title_align":"left","show_legend":true,"legend_size":"0"},"layout":{"x":172,"y":144,"width":57,"height":24}},{"id":36,"definition":{"type":"timeseries","requests":[{"q":"sum:kubernetes.network.rx_bytes{*,*,*,*,*,*,*} by {pod_name}, sum:kubernetes.network.tx_bytes{*,*,*,*,*,*,*} by {pod_name}","display_type":"line","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"Network Rate by Pod","title_size":"16","title_align":"left","show_legend":true,"legend_size":"0"},"layout":{"x":115,"y":168,"width":57,"height":24}},{"id":37,"definition":{"type":"timeseries","requests":[{"q":"sum:kubernetes.network.rx_errors{*,*,*,*,*,*,*} by {pod_name}, sum:kubernetes.network.tx_errors{*,*,*,*,*,*,*} by {pod_name}","display_type":"line","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"}}],"yaxis":{"label":"","scale":"linear","min":"auto","max":"auto","include_zero":true},"title":"Network Errors by Pod","title_size":"16","title_align":"left","show_legend":true,"legend_size":"0"},"layout":{"x":172,"y":168,"width":57,"height":24}},{"id":38,"definition":{"type":"query_value","requests":[{"q":"sum:kubernetes.pods.running{*}","aggregator":"avg","conditional_formats":[{"comparator":">","value":0,"palette":"green_on_white"}]}],"title":"Pods Running","title_size":"16","title_align":"left","precision":0},"layout":{"x":149,"y":5,"width":17,"height":14}},{"id":39,"definition":{"type":"note","content":"Overview","background_color":"gray","font_size":"18","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"bottom"},"layout":{"x":115,"y":0,"width":114,"height":5}},{"id":40,"definition":{"type":"query_value","requests":[{"q":"sum:docker.containers.stopped{*,*,*}","aggregator":"avg","conditional_formats":[{"comparator":">","value":0,"palette":"yellow_on_white"}]}],"title":"Stopped containers","title_size":"13","title_align":"center","time":{"live_span":"5m"},"autoscale":true,"precision":0,"text_align":"center"},"layout":{"x":132,"y":5,"width":17,"height":14}},{"id":41,"definition":{"type":"query_value","requests":[{"q":"sum:docker.containers.running{*,*,*}","aggregator":"avg","conditional_formats":[{"comparator":">","value":0,"palette":"green_on_white"}]}],"title":"Running containers","title_size":"13","title_align":"center","time":{"live_span":"5m"},"autoscale":true,"precision":0,"text_align":"center"},"layout":{"x":115,"y":5,"width":17,"height":14}},{"id":42,"definition":{"type":"query_value","requests":[{"q":"sum:kubernetes_state.deployment.replicas_available{*}","aggregator":"avg","conditional_formats":[{"comparator":">","value":0,"palette":"green_on_white"}]}],"title":"Deploy Available","title_size":"16","title_align":"left","time":{"live_span":"5m"},"autoscale":true,"precision":0},"layout":{"x":214,"y":5,"width":15,"height":14}},{"id":43,"definition":{"type":"query_value","requests":[{"q":"sum:kubernetes_state.deployment.replicas_desired{*}","aggregator":"avg","conditional_formats":[{"comparator":">","value":0,"palette":"custom_text","custom_fg_color":"#6a53a1"}]}],"title":"Delploy desired","title_size":"16","title_align":"left","time":{"live_span":"5m"},"autoscale":true,"precision":0},"layout":{"x":198,"y":5,"width":16,"height":14}},{"id":44,"definition":{"type":"query_value","requests":[{"q":"sum:kubernetes_state.daemonset.desired{*}","aggregator":"last","conditional_formats":[{"comparator":">","value":0,"palette":"custom_text","custom_fg_color":"#6a53a1"}]}],"title":"데몬셋 Desired","title_size":"16","title_align":"left","time":{"live_span":"5m"},"autoscale":true,"precision":0},"layout":{"x":166,"y":5,"width":16,"height":14}},{"id":45,"definition":{"type":"query_value","requests":[{"q":"sum:kubernetes_state.daemonset.ready{*}","aggregator":"last","conditional_formats":[{"comparator":">","value":0,"palette":"green_on_white"},{"comparator":"<=","value":0,"palette":"red_on_white"}]}],"title":"데몬셋 Ready","title_size":"16","title_align":"left","time":{"live_span":"5m"},"autoscale":true,"precision":0},"layout":{"x":182,"y":5,"width":16,"height":14}},{"id":46,"definition":{"type":"event_timeline","query":"sources:kubernetes","tags_execution":"and","title":"Number of Kubernetes events per node","title_size":"16","title_align":"left","time":{"live_span":"1d"}},"layout":{"x":4,"y":125,"width":49,"height":9}},{"id":47,"definition":{"type":"log_stream","indexes":[],"query":"cluster-name:analysis-production","sort":{"column":"time","order":"desc"},"columns":["core_host","core_service"],"show_date_column":true,"show_message_column":true,"message_display":"expanded-md","title":"$cluster-name 로그","title_size":"16","title_align":"left"},"layout":{"x":54,"y":124,"width":60,"height":69}},{"id":48,"definition":{"type":"note","content":"Evnet & Log","background_color":"vivid_yellow","font_size":"24","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"right"},"layout":{"x":4,"y":119,"width":110,"height":5}},{"id":49,"definition":{"type":"event_stream","query":"sources:kubernetes","tags_execution":"and","event_size":"l","title":"","title_size":"16","title_align":"left"},"layout":{"x":4,"y":136,"width":49,"height":57}}],"template_variables":[{"name":"CloudProvider","default":"*","prefix":"cloud_provider"},{"name":"Host","default":"*","prefix":"host"},{"name":"cluster-name","default":"analysis-production","prefix":"cluster-name"}],"layout_type":"free","is_read_only":false,"notify_list":[],"id":"jhd-ghu-ixg"}